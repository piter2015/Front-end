{"version":3,"file":"index.js","sources":["timeline.js","../src/index.js"],"sourcesContent":["import 'core-js/modules/es7.symbol.async-iterator';\nimport 'core-js/modules/es6.symbol';\nimport 'core-js/modules/web.dom.iterable';\nimport 'core-js/modules/es6.date.now';\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction cubicBezier(p1x, p1y, p2x, p2y) {\n  var ZERO_LIMIT = 1e-6; // Calculate the polynomial coefficients,\n  // implicit first and last control points are (0,0) and (1,1).\n\n  var ax = 3 * p1x - 3 * p2x + 1;\n  var bx = 3 * p2x - 6 * p1x;\n  var cx = 3 * p1x;\n  var ay = 3 * p1y - 3 * p2y + 1;\n  var by = 3 * p2y - 6 * p1y;\n  var cy = 3 * p1y;\n\n  function sampleCurveDerivativeX(t) {\n    // `ax t^3 + bx t^2 + cx t' expanded using Horner 's rule.\n    return (3 * ax * t + 2 * bx) * t + cx;\n  }\n\n  function sampleCurveX(t) {\n    return ((ax * t + bx) * t + cx) * t;\n  }\n\n  function sampleCurveY(t) {\n    return ((ay * t + by) * t + cy) * t;\n  } // Given an x value, find a parametric value it came from.\n\n\n  function solveCurveX(x) {\n    var t2 = x;\n    var derivative;\n    var x2; // https://trac.webkit.org/browser/trunk/Source/WebCore/platform/animation\n    // First try a few iterations of Newton's method -- normally very fast.\n    // http://en.wikipedia.org/wiki/Newton's_method\n\n    for (var i = 0; i < 8; i++) {\n      // f(t)-x=0\n      x2 = sampleCurveX(t2) - x;\n\n      if (Math.abs(x2) < ZERO_LIMIT) {\n        return t2;\n      }\n\n      derivative = sampleCurveDerivativeX(t2); // == 0, failure\n\n      /* istanbul ignore if */\n\n      if (Math.abs(derivative) < ZERO_LIMIT) {\n        break;\n      }\n\n      t2 -= x2 / derivative;\n    } // Fall back to the bisection method for reliability.\n    // bisection\n    // http://en.wikipedia.org/wiki/Bisection_method\n\n\n    var t1 = 1;\n    /* istanbul ignore next */\n\n    var t0 = 0;\n    /* istanbul ignore next */\n\n    t2 = x;\n    /* istanbul ignore next */\n\n    while (t1 > t0) {\n      x2 = sampleCurveX(t2) - x;\n\n      if (Math.abs(x2) < ZERO_LIMIT) {\n        return t2;\n      }\n\n      if (x2 > 0) {\n        t1 = t2;\n      } else {\n        t0 = t2;\n      }\n\n      t2 = (t1 + t0) / 2;\n    } // Failure\n\n\n    return t2;\n  }\n\n  function solve(x) {\n    return sampleCurveY(solveCurveX(x));\n  }\n\n  return solve;\n}\nvar ease = cubicBezier(0.25, 0.1, 0.25, 1);\n\nvar StyleNumberAnimation =\n/*#__PURE__*/\nfunction () {\n  function StyleNumberAnimation(el, property, startTime, startValue, endTime, endValue, converter) {\n    _classCallCheck(this, StyleNumberAnimation);\n\n    this._el = el;\n    this._property = property;\n    this._startTime = startTime;\n    this._startValue = startValue;\n    this._endTime = endTime;\n    this._endValue = endValue;\n    this._converter = converter;\n    this._needFixKeyFrame = false;\n    this._finish = false;\n  }\n\n  _createClass(StyleNumberAnimation, [{\n    key: \"tick\",\n    value: function tick(t) {\n      if (t >= this._endTime) {\n        if (this._needFixKeyFrame) {\n          t = this._endTime;\n          this._needFixKeyFrame = false;\n          this._finish = true;\n        } else {\n          return;\n        }\n      } else if (t <= this._startTime) {\n        if (this._needFixKeyFrame) {\n          t = this._startTime;\n          this._needFixKeyFrame = false;\n          this._finish = true;\n        } else {\n          return;\n        }\n      } else {\n        this._needFixKeyFrame = true;\n      }\n\n      this._el.style[this._property] = this._converter(ease((t - this._startTime) / (this._endTime - this._startTime)) * (this._endValue - this._startValue) + this._startValue);\n    }\n  }, {\n    key: \"finish\",\n    get: function get() {\n      return this._finish;\n    }\n  }]);\n\n  return StyleNumberAnimation;\n}();\n\nvar StyleVectorAnimation =\n/*#__PURE__*/\nfunction () {\n  function StyleVectorAnimation(el, property, startTime, startValue, endTime, endValue, converter) {\n    _classCallCheck(this, StyleVectorAnimation);\n\n    this._el = el;\n    this._property = property;\n    this._startTime = startTime;\n    this._startValue = startValue;\n    this._endTime = endTime;\n    this._endValue = endValue;\n    this._converter = converter;\n    this._needFixKeyFrame = false;\n    this._finish = false;\n  }\n\n  _createClass(StyleVectorAnimation, [{\n    key: \"tick\",\n    value: function tick(t) {\n      if (t >= this._endTime) {\n        if (this._needFixKeyFrame) {\n          t = this._endTime;\n          this._needFixKeyFrame = false;\n          this._finish = true;\n        } else {\n          return;\n        }\n      } else if (t <= this._startTime) {\n        if (this._needFixKeyFrame) {\n          t = this._startTime;\n          this._needFixKeyFrame = false;\n          this._finish = true;\n        } else {\n          return;\n        }\n      } else {\n        this._needFixKeyFrame = true;\n      }\n\n      var progress = (t - this._startTime) / (this._endTime - this._startTime);\n      var currentValues = [];\n\n      for (var i = 0; i < this._endValue.length; i++) {\n        // eslint-disable-next-line no-multi-spaces\n        currentValues[i] = ease(progress) * (this._endValue[i] - this._startValue[i]) + this._startValue[i];\n      }\n\n      this._el.style[this._property] = this._converter(currentValues);\n    }\n  }, {\n    key: \"finish\",\n    get: function get() {\n      return this._finish;\n    }\n  }]);\n\n  return StyleVectorAnimation;\n}();\n\nvar Timeline =\n/*#__PURE__*/\nfunction () {\n  // inited, started, paused\n  function Timeline() {\n    _classCallCheck(this, Timeline);\n\n    this._animations = []; // 记录timeline的状态, inited, started, paused\n\n    this._pauseTime = 0; // 记录总暂停时间累加\n\n    this._rate = 1;\n    this._startPoint = 0;\n    this.status = 'inited';\n    this._startTime = null;\n    this.num = 0;\n  }\n\n  _createClass(Timeline, [{\n    key: \"start\",\n    value: function start() {\n      var _this = this;\n\n      if (this.status === 'started') return;\n      this.status = 'started';\n\n      if (!this._startTime) {\n        this._startTime = Date.now();\n      }\n\n      var startTime = Date.now(); // 记录开始时间\n\n      this._tick = function () {\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n          for (var _iterator = _this._animations[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var animation = _step.value;\n\n            if (!animation.finish) {\n              console.log(startTime);\n              console.log('动画间隔:', Date.now() - startTime);\n              animation.tick((Date.now() - startTime - _this._pauseTime) * _this._rate + _this._startPoint);\n            }\n          }\n        } catch (err) {\n          _didIteratorError = true;\n          _iteratorError = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n              _iterator[\"return\"]();\n            }\n          } finally {\n            if (_didIteratorError) {\n              throw _iteratorError;\n            }\n          }\n        }\n\n        if (_this._tick) {\n          console.log('执行下一帧');\n          requestAnimationFrame(_this._tick);\n        } else {\n          console.log('this._tick为null');\n        }\n      }; // 每一帧需要执行的函数\n\n\n      requestAnimationFrame(this._tick); // 执行一帧动画\n    }\n  }, {\n    key: \"restart\",\n    value: function restart() {\n      var _this2 = this;\n\n      // TODO: restart的前一帧会出现继续使用上一个startTime的情况\n      if (this._tick) {\n        this._tick = null;\n        this._resumeTick = null;\n        console.log('清空this._tick');\n      }\n\n      this._startTime = null;\n      this.status = 'inited'; // this.start();\n\n      if (this.num === 0) {\n        requestAnimationFrame(function () {\n          console.log('重新执行');\n\n          _this2.start();\n        });\n      }\n    }\n  }, {\n    key: \"pause\",\n    value: function pause() {\n      if (this.status !== 'started') return;\n      this._pauseStart = Date.now(); // 记录暂停时间戳\n\n      this.status = 'paused';\n      this._resumeTick = this._tick; // 缓存_tickFunc\n\n      this._tick = null; // 清空_tickFunc，requestAnimationFrame的执行依赖于_tickFunc是否有值\n    }\n  }, {\n    key: \"remuse\",\n    value: function remuse() {\n      if (this.status !== 'paused') return;\n      this.status = 'started';\n      this._pauseTime += Date.now() - this._pauseStart; // 累加暂停时间\n\n      this._tick = this._resumeTick; // 重新为_tick赋值\n\n      requestAnimationFrame(this._tick); // 进行下一帧动画\n    }\n  }, {\n    key: \"addAnimation\",\n    value: function addAnimation(animation) {\n      this._animations.push(animation);\n    } // removeAnimation(animation) {}\n\n  }, {\n    key: \"clearAnimations\",\n    value: function clearAnimations() {\n      console.log('clearAnimations');\n      this._animations = [];\n    }\n  }, {\n    key: \"clearTick\",\n    value: function clearTick() {\n      if (this._tick) {\n        this._tick = null;\n        this._resumeTick = null;\n      }\n    }\n  }, {\n    key: \"startPoint\",\n    set: function set(value) {\n      this._startPoint = value;\n    },\n    get: function get() {\n      return this._startPoint;\n    }\n  }, {\n    key: \"rate\",\n    set: function set(value) {\n      this._rate = value;\n    },\n    get: function get() {\n      return this._rate;\n    }\n  }]);\n\n  return Timeline;\n}();\n\nexport default Timeline;\nexport { StyleNumberAnimation, StyleVectorAnimation };\n","import Timeline, { StyleNumberAnimation } from '../dist/timeline';\n\nconsole.log(Timeline, StyleNumberAnimation);\n"],"names":["_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","cubicBezier","p1x","p1y","p2x","p2y","ZERO_LIMIT","ax","bx","cx","ay","by","cy","sampleCurveDerivativeX","t","sampleCurveX","sampleCurveY","solveCurveX","x","t2","derivative","x2","Math","abs","t1","t0","solve","ease","StyleNumberAnimation","el","property","startTime","startValue","endTime","endValue","converter","_el","_property","_startTime","_startValue","_endTime","_endValue","_converter","_needFixKeyFrame","_finish","value","tick","style","get","Timeline","_animations","_pauseTime","_rate","_startPoint","status","num","start","_this","Date","now","_tick","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_iterator","Symbol","iterator","_step","next","done","animation","finish","console","log","err","requestAnimationFrame","restart","_this2","_resumeTick","pause","_pauseStart","remuse","addAnimation","push","clearAnimations","clearTick","set"],"mappings":"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"}